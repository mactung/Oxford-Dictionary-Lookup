import{c as D,r as o,j as e,S as u,X as R,L as V,V as C,T as M,p as T,s as U,b as A,R as F}from"./index.js";/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=D("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);function O(){var y;const[d,f]=o.useState(""),[a,h]=o.useState(null),[v,p]=o.useState(!1),[g,x]=o.useState(null),[m,i]=o.useState(!1),[b,w]=o.useState(null);o.useEffect(()=>{chrome.storage.local.get(["token"],t=>{t.token&&w(t.token)})},[]);const N=t=>{chrome.storage.local.get(["vocabulary"],async r=>{const s=r.vocabulary||[];try{const l=await U(t,s);if(l.success&&l.vocabulary){console.log("Sync success, merging...");const n=l.vocabulary,L=new Map(s.map(c=>[c.headword,c])),j=[...s];n.forEach(c=>{L.has(c.headword)||j.push({headword:c.headword,pos:"unknown",srsLevel:c.srs_level,nextReview:new Date(c.next_review).getTime(),contextUrl:"Synced",definition:"Synced from other device"})}),chrome.storage.local.set({vocabulary:j})}}catch(l){console.error("Sync failed",l)}})};o.useEffect(()=>{a&&a.headword?S(a.headword):i(!1)},[a]);const S=t=>{chrome.storage.local.get(["vocabulary"],r=>{const l=(r.vocabulary||[]).some(n=>n.headword===t);i(l)})},k=()=>{if(!a||!a.headword)return;const t=!m;i(t),chrome.storage.local.get(["vocabulary"],r=>{const s=r.vocabulary||[];let l;t?s.some(n=>n.headword===a.headword)?l=s:l=[...s,{...a,contextUrl:"Extension Popup",srsLevel:0,nextReview:Date.now()}]:l=s.filter(n=>n.headword!==a.headword),l&&chrome.storage.local.set({vocabulary:l},()=>{b&&N(b)})})},z=t=>{t.preventDefault(),d.trim()&&(p(!0),x(null),h(null),i(!1),chrome.runtime.sendMessage({action:"fetchDefinition",word:d.trim()},r=>{if(p(!1),r&&r.success){const s=T(r.html);s.error?x(s.error):(h(s),chrome.runtime.sendMessage({action:"syncToCloud",data:s}))}else x((r==null?void 0:r.error)||"Failed to fetch definition")}))},E=t=>{t&&new Audio(t).play()};return e.jsxs("div",{className:"w-[400px] h-[500px] bg-gray-50 flex flex-col font-sans",children:[e.jsxs("div",{className:"bg-oxford-blue p-4 shrink-0 flex items-center gap-2",children:[e.jsxs("form",{onSubmit:z,className:"relative flex-1",children:[e.jsx(u,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",className:"w-full pl-10 pr-4 py-2 rounded-lg bg-white/10 text-white placeholder-blue-200 border border-white/20 focus:outline-none focus:bg-white focus:text-gray-900 focus:placeholder-gray-400 transition-all text-sm",placeholder:"Search Oxford Dictionary...",value:d,onChange:t=>f(t.target.value),autoFocus:!0}),d&&e.jsx("button",{type:"button",onClick:()=>{f(""),h(null),x(null),i(!1)},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:e.jsx(R,{size:14})})]}),a&&e.jsx("button",{onClick:k,className:`p-2 rounded-lg transition-colors border ${m?"bg-yellow-400 text-white border-yellow-500 hover:bg-yellow-500":"bg-white/10 text-gray-300 border-white/20 hover:bg-white/20 hover:text-white"}`,title:m?"Remove from learning list":"Save to learning list",children:e.jsx(I,{size:20,fill:m?"currentColor":"none"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:v?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 space-y-2",children:[e.jsx(V,{className:"animate-spin text-oxford-blue",size:32}),e.jsx("span",{className:"text-sm font-medium",children:"Searching..."})]}):g?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center p-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-50 text-red-500 rounded-full flex items-center justify-center mb-3",children:e.jsx(u,{size:24})}),e.jsx("p",{className:"text-gray-900 font-bold mb-1",children:"No results found"}),e.jsx("p",{className:"text-gray-500 text-sm",children:g})]}):a?e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("div",{className:"flex items-baseline gap-2 mb-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:a.headword}),e.jsx("span",{className:"text-sm italic text-gray-500 font-serif",children:a.pos})]}),a.phonetics&&a.phonetics.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:a.phonetics.map((t,r)=>e.jsxs("div",{className:"flex items-center gap-1.5 bg-blue-50 px-2 py-1 rounded-md text-oxford-blue text-xs border border-blue-100",children:[t.type&&e.jsx("span",{className:"font-bold text-[10px] uppercase text-blue-400",children:t.type}),e.jsxs("span",{className:"font-mono",children:["/",t.ipa,"/"]}),t.audioUrl&&e.jsx("button",{onClick:()=>E(t.audioUrl),className:"hover:scale-110 transition-transform ml-0.5",children:e.jsx(C,{size:12})})]},r))}),e.jsx("div",{className:"space-y-4 mb-6",children:(y=a.senses)==null?void 0:y.map((t,r)=>e.jsx("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex gap-2.5",children:[e.jsx("span",{className:"text-oxford-blue font-bold text-xs bg-blue-50 h-5 w-5 flex items-center justify-center rounded-full shrink-0 border border-blue-100 mt-0.5",children:r+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-800 text-sm mb-2 leading-snug",children:t.definition}),t.synonyms&&t.synonyms.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-2.5",children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider mt-0.5",children:"Syns:"}),t.synonyms.map((s,l)=>e.jsx("span",{className:"bg-gray-50 px-1.5 py-0.5 rounded text-[10px] text-gray-600 font-medium border border-gray-100",children:s},l))]}),t.examples&&t.examples.length>0&&e.jsx("ul",{className:"space-y-1 pl-2 border-l-2 border-orange-100/50",children:t.examples.map((s,l)=>e.jsx("li",{className:"text-xs text-gray-500 italic",children:typeof s=="object"?e.jsxs(e.Fragment,{children:[s.pattern&&e.jsx("span",{className:"font-bold text-oxford-blue not-italic mr-1",children:s.pattern}),s.text]}):s},l))})]})]})},r))}),a.idioms&&a.idioms.length>0&&e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[e.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-3 flex items-center gap-1.5",children:[e.jsx(M,{size:14})," Idioms"]}),e.jsx("div",{className:"space-y-2",children:a.idioms.map((t,r)=>e.jsxs("div",{className:"bg-orange-50/50 p-2.5 rounded-lg border border-orange-100/50",children:[e.jsx("p",{className:"font-bold text-gray-800 text-xs mb-0.5",children:t.phrase}),e.jsx("p",{className:"text-[10px] text-gray-500",children:t.definition})]},r))})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("a",{href:`https://www.oxfordlearnersdictionaries.com/definition/english/${a.headword}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-oxford-blue hover:underline font-medium",children:"View full entry on Oxford Learners Dictionaries"})})]}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-300",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4 text-gray-400",children:e.jsx(u,{size:32})}),e.jsx("p",{className:"font-medium text-gray-400",children:"Search for a word"})]})})]})}A.createRoot(document.getElementById("root")).render(e.jsx(F.StrictMode,{children:e.jsx(O,{})}));
